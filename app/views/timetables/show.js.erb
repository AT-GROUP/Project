$('table').html("<tr><th></th><% (Date.new(@date.year, @date.month, 01)..Date.new(@date.year, @date.month, -1)).each do |date| %><th><%= date.strftime("%d") %></th><% end %></tr>");
<% @timetables.each do |timetable| %>
  $('table').append("<%= j (render timetable) %>");
  $("#show_<%=timetable.id%>").remove(); // delete checkbox from groups_form
<% end %>

//to create new event
$(document).on('click', 'td.events', function () {
  if ($('div', this).length == 0) { //true if $(this) dont include divs
    newEvent($(this).data('week'), $(this).parent().data('timetable'))
    $('#addTo').removeAttr('id'); // must be only one 'addTo'
    $(this).attr('id', 'addTo'); // save td to add div.events
  }
  ;
});
$('div.events').draggable({
  containment: 'table',
  revert: 'invalid'
});
$('td.events').droppable({
  accept: 'div.events',
  tolerance: 'intersect',
  drop: function (event, ui) {
    if ($('div', this).length == 0) {
      $div = $(ui.draggable);
      $div.appendTo($(this));
      var event_id = $div.data('event');
      var week = $(this).data('week');
      var timetable_id = $(this).parent().data('timetable');
      moveEvent(event_id, week, timetable_id);
      $div.css({
        'top': '0px',
        'left': '0px'
      });
    } else {
      $(ui.draggable).animate({top: 0, left: 0}, 'slow'); //revert
    }
  }
});
$('#download').fadeOut(400);
